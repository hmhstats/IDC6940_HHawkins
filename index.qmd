---
title: "A Statistical Analysis of Secondary Traumatic Stress (STS) and Teacher Attrition"
subtitle: "Using Binary Logistic Regression to Predict Teacher Attrition Based on Secondary Traumatic Stress (STS)"
author: "Hailee Hawkins (Advisors: Dr. Achraf Cohen, Dr. Melanie DiLoreto)"
date: '`r Sys.Date()`'
format:
  html:
    code-fold: true
    toc: true
    toc-depth: 4
course: Capstone Projects in Data Science
bibliography: references.bib # file contains bibtex for references
#always_allow_html: true # this allows to get PDF with HTML features
self-contained: true
execute: 
  warning: false
  message: false
editor: 
  markdown: 
    wrap: 72
---

Slides: [slides.html](slides.html){target="_blank"} 

## Introduction

Secondary traumatic stress (STS) is an issue that affects people in many fields of work. This paper focuses on how secondary traumatic stress influences a teacher’s decision to stay in or leave the field of education (attrition). Baird and Kracen say, "Secondary traumatic stress (STS) [@figley1995compassion] [@stamm1995secondary] refers to a syndrome among professional helpers that mimics post-traumatic stress disorder and occurs as a result of exposure to the traumatic experiences of others" [@baird2006vicarious]. Bride explains, "...secondary traumatic stress was operationalized as intrusion, avoidance, and arousal symptoms resulting from indirect exposure to traumatic events by means of a professional helping relationship with a person or persons who have directly experienced traumatic events" [@bride2004development]. These symptoms will be discussed in greater detail later in this paper.

 In schools, teachers can be exposed to traumatic events directly or indirectly. For example, teachers may witness or experience violence such as fights, shootings, physical aggression or other safety threats. They also may learn about students who have experienced trauma through abuse, neglect or violence in their family or community [@inabnett2023secondary]. Teacher’s indirect exposure to trauma may stem from the fact that many students who attend high-needs or Title 1 schools live in poverty. Title 1 is a federal program that provides money to schools with high percentages of children from low-income families [@diaz2017student]. Teachers who work in high-needs schools or Title 1 schools are likely to develop symptoms of secondary traumatic stress due to the experiences of the students they work with. 

Discussions about secondary traumatic stress are relevant for the overall well being of people in service professions, including teachers in high-needs schools. Kidger says, "Our findings show that how teachers feel about their working conditions, that is how stressed or dissatisfied they are, may be linked to poor mental health" [@kidger2016teachers]. Teachers cannot predict when traumatic events will occur for their students or themselves. McEwen and Akil explain, "... if stress related demands continue, then the brain can “get stuck,” ... leading to pathological conditions where external intervention is needed. Examples of such conditions are clinical anxiety or major depression, which may
 begin with an appropriate response to a stressful event but become maladaptive when they persist and become chronic" [@mcewen2020revisiting]. These findings affirm that secondary traumatic stress affects teachers mentally and physically.

Another reason to discuss secondary traumatic stress is because of its association with attrition. Baker says, "Chronic stress at work, combined with a lack of support and resources, can lead to professional burnout" [@baker2021experience]. Chang says, " ... scholars have adopted the MBI scale developed by Maslach and Jackson [@maslach1981measurement] which measures the psychological syndrome of burnout in three dimensions: emotional exhaustion, cynicism, and inefficacy" [@chang2009appraisal]. De Stasio explains, "Personal burnout is the physical and psychological fatigue and exhaustion experienced by an individual—regardless of their work or occupational status. Work-related burnout is deﬁned as the degree of physical and psychological fatigue and exhaustion perceived by the teacher speciﬁcally in relation to his/her work. Finally, student-related burnout refers to the physical and psychological fatigue and exhaustion that is perceived by the teacher in relation to his/her work with students" [@de2017burnout]. When burnout is experienced in the workplace, it not only affects teachers mentally and physically, but also emotionally. In a study by Hilton, it was found that “The more a teacher feels stressed or disappointed, the more likely they are to leave the profession” [@hilton2021predicting]. These findings confirm that secondary traumatic stress may result in burnout which can lead to teacher attrition.

Secondary traumatic stress can be measured using the Secondary Traumatic Stress Scale (STSS). Bride explains, "... the final version of the STSS is a 17-item, pencil-and-paper, self-report instrument designed to assess the frequency of intrusion, avoidance, and arousal symptoms associated with secondary traumatic stress. Respondents are instructed to read each item and indicate how frequently the item was true for them in the past 7 days using a five-choice, Likert-type response format ranging from 1(never) to 5 (very often). The STSS is comprised of three subscales: Intrusion (items 2, 3, 6, 10, 13), Avoidance (items 1, 5, 7, 9, 12, 14, 17), and Arousal (items 4, 8, 11,15, 16). Scores for the full STSS (all items) and each subscale are obtained by summing the items assigned to each. " [@bride2004development]. Previous research has been done to understand secondary traumatic stress, measure its symptoms and learn how it affects teacher attrition.

In 2023, Inabnett did a study to see if secondary traumatic stress contributes to teacher attrition beyond other known factors, namely teacher self-efficacy and classroom demands. In the study, teachers working in a high-needs school district in Louisiana were surveyed. Several scales - including the Secondary Traumatic Stress Scale (STSS) - were used to measure levels of depression, anxiety and stress, secondary traumatic stress, teacher self-efficacy and classroom resources and demands. The study included 104 participants.

Inabnett found, "Overall, 82 participants reported direct exposure to a traumatic event (77.88%), 88 participants reported indirect exposure to a traumatic event (84.61%), and 76 participants reported direct and indirect exposure to a traumatic event (73.08%). Approximately 23 participants (22.1%) reported it was likely or extremely likely they would leave the teaching profession in the next year; 28 participants (26.9%) reported it was likely or extremely likely they would leave their current school in the next year" [@inabnett2023secondary].

Binary logistic regression models were used to predict if a teacher would leave the profession and if a teacher would leave their current school. For both models, the predictors of teacher attrition were class size, classroom demands, teacher self-efficacy and secondary traumatic stress. In both models, including secondary traumatic stress as a predictor of attrition significantly improved the model’s prediction accuracy. The results of Inabnett’s study showed that secondary traumatic stress was a significant predictor of teacher attrition beyond teacher self-efficacy and classroom resources and demands. 

In 2021, Hilton used the School and Staffing Survey (SASS) and the Teacher Follow Up Survey (TFS) to identify what factors would predict teacher attrition. The 2011-2012 SASS dataset used in the analysis is a nationally representative dataset provided by the National Center for Education Statistics. It includes responses from almost 60,000 private and public school teachers. The researcher limited the sample size to around 4,000 after removing the private school teacher responses due to a low number of responses from private school teachers on the 2012-2013 TFS. The factors studied were teacher autonomy, school climate, student characteristics and a teacher’s general attitudes toward the profession (purpose). Though this study did not directly address secondary traumatic stress as a factor of attrition, the findings may suggest STS as an underlying factor.

For example, the study found that “student apathy toward school has an impact on teacher
retention decisions” [@hilton2021predicting]. Students experiencing trauma can become indifferent toward school, and teachers who are experiencing symptoms of secondary traumatic stress may exhaust themselves in attempts to reach these students. This could result in teachers becoming indifferent toward trauma-affected students which is an indication of burnout. Chang mentioned, “When a person feels exhausted or indifferent toward serving or helping people, it is difficult to gain a sense of accomplishment” [@chang2009appraisal]. If a teacher does not feel a sense of accomplishment from their work, and they are experiencing symptoms of secondary traumatic stress and burnout, they may leave their job. Though Hilton’s study does not directly mention this connection, it is possible that secondary traumatic stress could further explain how student apathy leads to teacher attrition. 

Another example of STS as an underlying factor affecting attrition comes from this finding, “Teachers felt that support by administration and support by other teachers was far more important regarding attrition decisions than simply the low salary or inadequate access to resources that come with teaching” [@hilton2021predicting]. New teachers who are not aware of secondary traumatic stress may experience its symptoms and not realize that there is a cause. Hahs-Vaughn and Scherff suggest, "... an induction component to combat stress and foster encouragement among novice teachers is membership in network (i.e., support) groups" [@hahs2008beginning]. Hilton’s findings in 2021 bring attention to how a lack of support from colleagues and administration can lead to teacher attrition even more than low pay and lack of resources. Though Hilton’s study does not directly mention a connection between this finding and secondary traumatic stress, it is possible that newer teachers are leaving the field because they are experiencing symptoms of STS not realizing that it is a phenomenon that can affect all teachers. In these situations, the support of veteran teachers and administrators who have experienced secondary traumatic stress could be a resource that may prevent teacher attrition.  

In an effort to build on the previous research, the current study focuses on predicting teacher attrition in Northwest Florida by using teacher’s responses to the Secondary Traumatic Stress Scale (STSS). The goal of this project is to explain statistically the impact that secondary traumatic stress has on teacher’s decisions to stay in or leave the profession. By analyzing how a teacher’s score for intrusion, avoidance and arousal affects their chance of leaving the profession, the hope is to reveal insight that can inform school administrators and district officials of the likelihood of teacher attrition so proper support and resources can be put in place for teachers. 


## Methods

In this project, binary logistic regression will be used to predict teacher attrition using responses to the Secondary Traumatic Stress Scale (STSS). Peng says “Many educational research problems call for the analysis and prediction of a dichotomous outcome: whether a student will succeed in college, whether a child should be classified as learning disabled (LD), whether a teenager is prone to engage in risky behaviors, and so on” [@peng2002introduction]. Binary logistic regression is useful when the outcome has two categories, such as predicting whether a teacher stays in or leaves the profession.

In binary logistic regression, the dependent (outcome) variable is binary and is modeled using one or more independent (predictor) variables. These predictors can be continuous or categorical. Categorical predictors with two or more levels are typically converted into dummy (indicator) variables, with one category chosen as the reference. The model then compares the effect of other categories relative to this reference. Tranmer explains, "If an explanatory variable has 𝑘 categories, we need 𝑘 − 1 dummy variables to investigate all the differences in the categories with respect to the response variable" [@tranmer2008binary].

In binary logistic regression analysis, the outcome (dependent) variable is typically coded as 0 and 1. An observation coded as 1 usually indicates that the outcome of interest occurred, whereas an observation coded as 0 indicates that it did not occur. As previously mentioned, categorical predictor variables are dummy-coded, where a value of 1 indicates membership in a category, and 0 indicates the reference category [@tranmer2008binary].

The probability of an event occurring given certain predictor variables can be modeled using the logistic regression function:

$$
\pi = P(Y=1 | X_1=x_1, X_2=x_2, \cdots, X_k=x_k)=\frac{1}{1 + e^{-(\beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_k x_k)}}
$$
where $\pi$ represents the probability of the event occurring, $Y$ is the binary outcome (dependent) variable, $e$ is Euler’s number (approximately 2.718), the base of the natural exponential function, and the $X_i$ are the predictor (independent) variables.
[@tranmer2008binary]
[@harris2021primer]
[@peng2002introduction]
[@abdulqader2017applying]

Two-way contingency tables can represent categorical information, facilitating the calculation of odds and odds ratios. Binary logistic regression relies on these concepts for interpretation. Odds compare the probability of an event occurring to the probability of it not occurring, while odds ratios compare the odds of the event between groups.

Binary logistic regression models the logit transformation of the event probability as a linear function of the predictors. The logit (or log-odds) is defined as the natural logarithm of the odds of the event occurring:

$$
logit(\pi)=\ln\left(\frac{\pi}{1 - \pi}\right) = \beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_k x_k
$$

where $\pi$ is the probability of the event, 
$\frac{\pi}{1 - \pi}$ represents the odds, 
$logit(\pi)$ is the log-odds,
$\beta_0$ is the intercept,
$\beta_i$ are the regression coefficients and 
$x_i$ are the predictor (independent) variables. 
[@tranmer2008binary]
[@harris2021primer]
[@peng2002introduction]
[@abdulqader2017applying]

Because the model returns log-odds, exponentiating coefficients yields odds ratios, quantifying the change in odds associated with a one-unit increase in a predictor, holding others constant. [@peng2002introduction] For example, an odds ratio of 1.5 indicates a 50% increase in the odds of the event occurring for each one-unit increase in the predictor, all else equal.

The logistic function transforms the linear predictor back into a probability bounded between 0 and 1:

$$
\pi=\frac{1}{1 + e^{-(\beta_0 + \beta_1 x_1 + \beta_2 x_2 + \cdots + \beta_k x_k)}}
$$

This expression represents the estimated probability that the event (e.g., teacher attrition) will occur, given specific values of the predictor variables.

Binary logistic regression relies on several assumptions:

1. The dependent variable is binary.
2. Observations are independent of each other.
3. There is no perfect multicollinearity among independent variables.
4. There is a linear relationship between any continuous predictors and the log odds of the outcome.
5. The sample size is sufficiently large, ideally with at least 10 outcome events per predictor variable.

When these assumptions are met, the results of a binary logistic regression analysis can be considered statistically reliable. [@tranmer2008binary] [@harris2021primer] [@abdulqader2017applying]

There are multiple approaches to selecting predictors in a binary logistic regression model. These include using the full model approach, eliminating predictors that are not significantly associated with the outcome based on their p-values, and applying stepwise selection techniques such as forward or backward elimination using criteria like the Akaike Information Criterion (AIC), among others [@shipe2019developing]. After fitting the model, its adequacy can be evaluated using various methods. These include goodness-of-fit tests, likelihood ratio tests, tests of statistical significance for individual predictors, and assessment of predictive performance using classification tables, among other diagnostics [@peng2002introduction] [@abdulqader2017applying].

RStudio will be used to perform the statistical analyses in this project. Several R packages provide functions for performing binary logistic regression and related tasks. These include lmtest, MASS, fastDummies, tidyverse, car, and the base stats package, among others. [@zeileis2002diagnostic] [@venables2013modern] [@kaplan2020fastdummies] [@wickham2019welcome] [@fox2020using] [@team2002r] 

The goal of this project is to predict teacher attrition using responses from the Secondary Traumatic Stress Scale (STSS). Given that teacher attrition is a binary outcome—indicating whether a teacher stays in or leaves the profession—binary logistic regression will be applied in this analysis. Predictor variables will include the subscale scores for intrusion, arousal, and avoidance from the STSS, which will be used to estimate the likelihood of a teacher leaving the profession.

## Analysis and Results

### Data Exploration and Visualization

For this analysis, data were gathered through a questionnaire designed by Dr. Melanie DiLoreto. Following approval from the district superintendent, the instrument was sent to school principals, who then distributed it to their teaching staff via email. Participants were teachers based in Northwest Florida. 

The survey included eight items assessing participants’ experiences with secondary traumatic stress (using items adapted from the Secondary Traumatic Stress Scale [STSS]; [@bride2004development]), compassion fatigue (from the Professional Quality of Life Scale [ProQOL]; [@stamm2005professional]), intentions to remain in or leave the teaching profession, and perceptions of whether secondary traumatic stress influenced that decision. For this analysis, only responses to the STSS (Item 3) and the participants’ intent to stay or leave teaching (Item 5) were examined.

Teacher attrition was operationalized as any decision to leave face-to-face classroom teaching, including career changes, retirement, or transitions to modalities that substantially reduce direct student interaction.

[View Questionnaire Item 3 (Secondary Traumatic Stress Scale)](STSS.pdf)

[View Questionnaire Item 5 (Teaching Career Intentions)](Questionnaire Item 5.pdf)

```{r, warning=FALSE, echo=T, message=FALSE}
library(ggplot2)
library(dplyr)
library(corrplot)
library(tidyverse)
library(knitr)
library(ggthemes)
library(ggrepel)
library(dslabs)
library(readr)
library(patchwork)
library(gt)
library(car)
library(tidyr)
library(broom)
library(ResourceSelection)
library(caret)

sts_data <- read_csv("sts_data.csv")


```

A total of 107 teachers responded to the questionnaire. Of these, three participants indicated uncertainty about whether they would continue or leave the teaching profession. Because the analysis required a definitive "yes" or "no" response regarding intent to stay or leave, these uncertain responses were excluded. The final sample included 104 teachers, with 70 indicating they intended to continue teaching and 34 indicating they planned to leave the profession. 

```{r, warning=FALSE, echo=TRUE}
# Recode intent as factor with labels
sts_data <- sts_data %>%
  mutate(leave_label = factor(leave_teaching, levels = c(0, 1), labels = c("Stay", "Leave")))

# Create bar plot with labels
ggplot(sts_data, aes(x = leave_label)) +
  geom_bar(fill = "steelblue") +
  geom_text(stat = "count", aes(label = ..count..), vjust = -0.3, size = 4) +
  labs(
    title = "Teacher Intentions to Leave the Profession",
    x = "Intent",
    y = "Count"
  ) +
  theme_minimal()

```


Density plots were generated to visualize the distribution and spread of scores for each STSS subscale—intrusion, avoidance, arousal—as well as the overall total score for secondary traumatic stress.

The total STSS scores varied widely across participants. Among teachers intending to continue teaching, scores peaked around 30 and 50, while those intending to leave showed a peak around 45. The plot suggests that higher total scores were more frequent among teachers planning to leave the profession.

For intrusion scores, both groups peaked between 11 and 14. Interestingly, scores within this range were slightly more common among teachers intending to stay. However, the plot also indicates that higher intrusion scores were more frequent among those intending to leave.

Avoidance scores peaked around 10 and 20 for teachers planning to stay, whereas teachers intending to leave showed a peak around 17. The distribution suggests that higher avoidance scores were more prevalent among those considering leaving teaching.

Arousal scores peaked around 9 and 12 for teachers intending to stay and around 17 for those intending to leave. Interestingly, the plot indicates that higher arousal scores were slightly more common among teachers intending to continue teaching.


```{r, warning=FALSE, echo=TRUE}
#range for x axis
x_limits <- c(0, 85)  

# Compute max densities manually
max_total <- max(density(sts_data$stss_total_score)$y)
max_intrusion <- max(density(sts_data$intrusion_score)$y)
max_avoidance <- max(density(sts_data$avoidance_score)$y)
max_arousal <- max(density(sts_data$arousal_score)$y)

# Get the global max y for uniform scale
y_max <- max(c(max_total, max_intrusion, max_avoidance, max_arousal))

# Ensure intent is treated as a factor
sts_data$intent_label <- factor(sts_data$leave_teaching, levels = c(0, 1), labels = c("Stay", "Leave"))

# Density plot: Total Score
p_total <- ggplot(sts_data, aes(x = stss_total_score, fill = intent_label)) +
  geom_density(alpha = 0.5) +
  xlim(x_limits) +
  coord_cartesian(ylim = c(0, y_max)) +
  labs(title = "Total STSS Score", x = "Total Score", fill = "Intent") +
  theme_minimal()

# Density plot: Intrusion
p_intrusion <- ggplot(sts_data, aes(x = intrusion_score, fill = intent_label)) +
  geom_density(alpha = 0.5) +
  xlim(x_limits) +
  coord_cartesian(ylim = c(0, y_max)) +
  labs(title = "Intrusion Score", x = "Intrusion", fill = "Intent") +
  theme_minimal()

# Density plot: Avoidance
p_avoidance <- ggplot(sts_data, aes(x = avoidance_score, fill = intent_label)) +
  geom_density(alpha = 0.5) +
  xlim(x_limits) +
  coord_cartesian(ylim = c(0, y_max)) +
  labs(title = "Avoidance Score", x = "Avoidance", fill = "Intent") +
  theme_minimal()

# Density plot: Arousal
p_arousal <- ggplot(sts_data, aes(x = arousal_score, fill = intent_label)) +
  geom_density(alpha = 0.5) +
  xlim(x_limits) +
  coord_cartesian(ylim = c(0, y_max)) +
  labs(title = "Arousal Score", x = "Arousal", fill = "Intent") +
  theme_minimal()

# Combine all 4 plots in a 2x2 layout, share the legend
(p_total | p_intrusion) / (p_avoidance | p_arousal) + 
  plot_layout(guides = "collect") & theme(legend.position = "bottom")
```


The table below presents summary statistics for both groups of teachers. It includes the total STSS score as well as the subscale scores for intrusion, avoidance, and arousal. For each score, the table provides the mean (average), standard deviation (SD), minimum (Min), and maximum (Max) values. 


```{r, warning=FALSE, echo=TRUE}

summary_table <- sts_data %>%
  mutate(Intent = factor(leave_teaching, labels = c("Stay", "Leave"))) %>%
  group_by(Intent) %>%
  summarise(
    Count = n(),
    Total_Mean = mean(stss_total_score, na.rm = TRUE),
    Total_SD = sd(stss_total_score, na.rm = TRUE),
    Total_Min = min(stss_total_score, na.rm = TRUE),
    Total_Max = max(stss_total_score, na.rm = TRUE),
    
    Intrusion_Mean = mean(intrusion_score, na.rm = TRUE),
    Intrusion_SD = sd(intrusion_score, na.rm = TRUE),
    Intrusion_Min = min(intrusion_score, na.rm = TRUE),
    Intrusion_Max = max(intrusion_score, na.rm = TRUE),
    
    Avoidance_Mean = mean(avoidance_score, na.rm = TRUE),
    Avoidance_SD = sd(avoidance_score, na.rm = TRUE),
    Avoidance_Min = min(avoidance_score, na.rm = TRUE),
    Avoidance_Max = max(avoidance_score, na.rm = TRUE),
    
    Arousal_Mean = mean(arousal_score, na.rm = TRUE),
    Arousal_SD = sd(arousal_score, na.rm = TRUE),
    Arousal_Min = min(arousal_score, na.rm = TRUE),
    Arousal_Max = max(arousal_score, na.rm = TRUE)
  )


# Pivot into long format, then wide with groups across top
summary_table_long <- summary_table %>%
  pivot_longer(
    cols = -Intent,                # All columns except the group
    names_to = "Measure",                # Column for "Mean_Total", etc.
    values_to = "Value"
  ) %>%
  pivot_wider(
    names_from = Intent,          # Create one column per group ("Stay", "Leave")
    values_from = Value
  )


kable(summary_table_long, digits = 2, caption = "Summary Statistics (Long Format, Intent Across Columns)")




```


Boxplots were generated to visually compare the distribution of scores across teacher intent groups. One notable outlier was observed in the intrusion scores, suggesting that a single respondent reported significantly higher levels of intrusion compared to the rest of the sample. Upon further examination, it is important to highlight that the maximum possible score for intrusion is 25. Interestingly, the respondent associated with this outlier also indicated an intention to leave the teaching profession.


```{r, warning=FALSE, echo=TRUE}


p_intrusion <- ggplot(sts_data, aes(x = leave_teaching, y = intrusion_score, fill = leave_teaching)) +
  geom_boxplot() +
  labs(title = "Intrusion", x = NULL, y = "Score") +
  theme_minimal()

p_avoidance <- ggplot(sts_data, aes(x = leave_teaching, y = avoidance_score, fill = leave_teaching)) +
  geom_boxplot() +
  labs(title = "Avoidance", x = NULL, y = "Score") +
  theme_minimal()

p_arousal <- ggplot(sts_data, aes(x = leave_teaching, y = arousal_score, fill = leave_teaching)) +
  geom_boxplot() +
  labs(title = "Arousal", x = "Intent", y = "Score") +
  theme_minimal()

p_total <- ggplot(sts_data, aes(x = leave_teaching, y = stss_total_score, fill = leave_teaching)) +
  geom_boxplot() +
  labs(title = "Total STSS", x = "Intent", y = "Score") +
  theme_minimal()

# Combine into 2x2 layout
(p_total | p_intrusion) / (p_avoidance | p_arousal) +
  plot_layout(guides = "collect") & theme(legend.position = "bottom")
```


Before conducting statistical comparisons between the two groups of teachers, tests for normality were performed to assess the distribution of the data.


$$
H_0= \text{The data is normally distributed.}
$$
$$
H_1= \text{The data is not normally distributed.}
$$

```{r, warning=FALSE, echo=TRUE}

# List of variable names to test
score_vars <- c("stss_total_score", "intrusion_score", "avoidance_score", "arousal_score")

# Loop over each variable and run Shapiro-Wilk test for each group
for (var in score_vars) {
  cat("\n--- Shapiro-Wilk test for", var, "---\n")
  
  stay_group <- sts_data[[var]][sts_data$leave_teaching == 0]
  leave_group <- sts_data[[var]][sts_data$leave_teaching == 1]
  
  cat("Stay group:\n")
  print(shapiro.test(stay_group))
  
  cat("Leave group:\n")
  print(shapiro.test(leave_group))
}

# Variables to test
score_vars <- c("stss_total_score", "intrusion_score", "avoidance_score", "arousal_score")

# Initialize empty data frame to store results
shapiro_results <- data.frame(
  Variable = character(),
  Group = character(),
  P_Value = numeric(),
  stringsAsFactors = FALSE
)

# Loop through each variable and group
for (var in score_vars) {
  # Subsets
  stay_group <- sts_data[[var]][sts_data$leave_teaching == 0]
  leave_group <- sts_data[[var]][sts_data$leave_teaching == 1]
  
  # Shapiro tests
  stay_test <- shapiro.test(stay_group)
  leave_test <- shapiro.test(leave_group)
  
  # Append results
  shapiro_results <- rbind(
    shapiro_results,
    data.frame(Variable = var, Group = "Stay", P_Value = stay_test$p.value),
    data.frame(Variable = var, Group = "Leave", P_Value = leave_test$p.value)
  )
}

# Print the result
print(shapiro_results)

# Optional: Save to CSV
# write.csv(shapiro_results, "shapiro_results.csv", row.names = FALSE)

```


The Shapiro-Wilk tests indicated that for teachers intending to continue teaching, the data for all four STSS subscales deviated from a normal distribution. Specifically, the p-values for the stay group were 0.01536 for STSS Total Score, 0.02752 for Intrusion, 0.008379 for Avoidance, and 0.0349 for Arousal—all below the 0.05 threshold, suggesting violations of the normality assumption. These results are consistent with density plots that visually diverge from the expected bell curve. In contrast, the data for teachers intending to leave teaching met the assumption of normality across all subscales, with p-values of 0.9717 (STSS Total), 0.7114 (Intrusion), 0.3975 (Avoidance), and 0.3525 (Arousal), each well above 0.05. Visual inspection of these distributions further supported normality, with density plots that more closely resemble normal distributions.

```{r, warning=FALSE, echo=TRUE}
# Create labeled version of leave_teaching before reshaping
sts_data <- sts_data %>%
  mutate(
    Teaching_Intent = factor(leave_teaching, levels = c(0, 1), labels = c("Stay", "Leave"))
  )

# Reshape the data to long format
sts_long <- sts_data %>%
  pivot_longer(
    cols = c(stss_total_score, intrusion_score, avoidance_score, arousal_score),
    names_to = "Score_Type",
    values_to = "Score_Value"
  )

# Create density plots for each subscale by teaching intent
ggplot(sts_long, aes(x = Score_Value, fill = Teaching_Intent)) +
  geom_density(alpha = 0.5) +
  facet_grid(Score_Type ~ Teaching_Intent, labeller = labeller(
    Score_Type = c(
      stss_total_score = "Total STSS",
      intrusion_score = "Intrusion",
      avoidance_score = "Avoidance",
      arousal_score = "Arousal"
    )
  )) +
  labs(
    title = "Density Plots of STSS Subscale Scores by Teaching Intent",
    x = "Score",
    y = "Density",
    fill = "Teaching Intent"
  ) +
  theme_minimal()
```


Because the normality assumption was not met for teachers intending to continue teaching, Wilcoxon rank-sum tests were used to compare STSS scores between those planning to stay and those planning to leave the profession.

$$
H_0= \text{The distributions of the two groups are the same.}
$$

$$
H_1= \text{The distributions of the two groups are different.}
$$


```{r, warning=FALSE, echo=TRUE}
scores <- c("stss_total_score", "intrusion_score", "avoidance_score", "arousal_score")

results <- lapply(scores, function(var) {
  test <- wilcox.test(as.formula(paste(var, "~ leave_teaching")), data = sts_data)
  data.frame(
    Score = var,
    W = test$statistic,
    p_value = test$p.value
  )
})

# Combine results into one table

bind_rows(results)


# Create the results data frame
test_results <- data.frame(
  Subscale = c("STSS Total Score", "Intrusion", "Avoidance", "Arousal"),
  W = c(867.0, 876.5, 885.5, 901.0),
  p_value = c(0.02537618, 0.02951149, 0.03489508, 0.04513017)
)

# Show as table
kable(test_results, digits = 3, caption = "Wilcoxon Rank-Sum Test Results by STSS Subscale")


```


All STSS subscale scores, as well as the total score, showed statistically significant differences between groups. Notably, total STSS scores (W = 867.0, p = 0.025), intrusion scores (W = 876.5, p = 0.030), avoidance scores (W = 885.5, p = 0.035), and arousal scores (W = 901.0, p = 0.045) were significantly higher among teachers intending to leave, suggesting elevated levels of secondary traumatic stress across multiple symptoms.

A correlation matrix was generated to examine the relationships between the STSS subscales and teachers’ attrition responses.

```{r, warning=FALSE, echo=TRUE}

# Add attrition variable (binary) to the matrix
stss_data2 <- sts_data[, c("intrusion_score", "avoidance_score", "arousal_score", "stss_total_score", "leave_teaching")]

# Correlation matrix (Pearson)
cor_matrix <- cor(stss_data2, use = "complete.obs")

# Visualize
library(corrplot)
corrplot(cor_matrix, method = "number", type = "upper", tl.col = "black", number.cex = 0.8)

```

Pearson correlation coefficients indicated strong to very strong positive associations among the STSS subscales. For instance, intrusion was strongly correlated with avoidance (r = 0.80) and arousal (r = 0.84). Avoidance and arousal were also highly correlated (r = 0.88). Each subscale showed very strong correlations with the total STSS score (r = 0.91–0.96), indicating a high degree of internal consistency within the scale.

In contrast, correlations between the STSS scores and intent to leave teaching were weak (r = 0.18–0.22), suggesting that while higher levels of secondary traumatic stress may be associated with a greater likelihood of considering attrition, the strength of this relationship is modest.

### Modeling and Results

The data for this analysis were collected through a questionnaire designed to assess teachers’ experiences with secondary traumatic stress and their intentions regarding their future in the profession. The Secondary Traumatic Stress Scale (STSS) was used, with Question 3 (Q3) allowing respondents to indicate how frequently a given statement had been true for them over the past seven days. Responses were recorded on a five-point Likert scale: Never (1), Rarely (2), Occasionally (3), Often (4), and Very Often (5). To explore teachers’ career intentions, Question 5 (Q5) asked respondents to indicate their anticipated career path within the next three years. Response options included: Continue teaching (1), Retire (2), Leave the teaching profession (3), Become an administrator (4), and Other (please explain) (5).

For the purposes of analysis, responses to Question 3 were recoded to reflect only the numerical values on the Likert scale (1 = Never, 2 = Rarely, 3 = Occasionally, 4 = Often, 5 = Very Often). Since Question 3 encompassed the items from the Secondary Traumatic Stress Scale (STSS), these responses were used to calculate subscale scores for Intrusion, Avoidance, and Arousal, as well as a total STSS score. Specifically, the Intrusion subscale score was calculated by summing the responses to items 2, 3, 6, 10, and 13. The Avoidance subscale score included items 1, 5, 7, 9, 12, 14, and 17. The Arousal subscale was based on items 4, 8, 11, 15, and 16. The total STSS score was obtained by summing all 17 items [@bride2004development].

Data from Question 5 were recoded into a binary variable to indicate whether respondents intended to leave or remain in the teaching profession. Responses were coded as 1 if the respondent indicated they would be leaving teaching—specifically, if they selected Retire (2), Leave the teaching profession (3), or Become an administrator (4). Responses were coded as 0 if the respondent indicated they would Continue teaching (1).

Five respondents selected Other (5). Of these, one stated they would continue teaching because they felt "stuck in the profession"; this response was recoded as 0. Another respondent indicated a move to online teaching. Given the study’s focus on daily, face-to-face student interaction as a key contributor to secondary traumatic stress, this response was recoded as 1, since the respondent would no longer be in direct contact with students. The remaining three respondents selected "Other" and expressed uncertainty about whether they would remain in or leave the profession. Because binary logistic regression requires a dichotomous outcome, these three cases were excluded from the final analysis. 


#### Model 1

A binary logistic regression analysis was conducted to determine whether scores on the Secondary Traumatic Stress Scale (STSS) could predict teachers’ intentions to leave the profession. The first model included the total STSS score as the sole predictor of teacher attrition.

$$ 
\ln(\text{attrition}) = -2.1175 + 0.0317(\text{Total STSS Score}) 
$$

```{r, warning=FALSE, echo=TRUE}
# Model 1: Logistic regression with total STSS score
model1 <- glm(leave_teaching ~ stss_total_score, data = sts_data, family = binomial)


# View model summary (coefficients, p-values, etc.)
summary(model1)

# Calculate odds ratios and 95% confidence intervals
exp(cbind(Odds_Ratio = coef(model1), confint(model1)))

```

The model was statistically significant, χ²(1, N = 104) = 4.94, p = .030, indicating that total STSS scores significantly predicted attrition intention. The odds of indicating an intention to leave teaching increased by 3.2% for each additional point on the STSS (OR = 1.03, 95% CI [1.00, 1.06]).

#### Model 2

A second binary logistic regression model was conducted to examine whether the three components of secondary traumatic stress—Intrusion, Avoidance, and Arousal—significantly predicted teachers’ intentions to leave the profession. This model used the subscale scores for each component as separate predictor variables to assess their individual contributions to teacher attrition. 

$$ 
\ln(\text{attrition}) = -2.1066 + 0.0922(\text{Intrusion Score}) + 0.0684(\text{Avoidance Score}) - 0.0724(\text{Arousal Score})
$$

```{r, warning=FALSE, echo=TRUE}
# Model 2: Logistic regression with STSS subscale scores
model2 <- glm(leave_teaching ~ intrusion_score + avoidance_score + arousal_score, data = sts_data, family = binomial)

# View model summary
summary(model2)

p_value <- 1 - pchisq(5.93, df = 3)
print(p_value)  # This will print approximately 0.115


# Calculate odds ratios and 95% confidence intervals
exp(cbind(Odds_Ratio = coef(model2), confint(model2)))

```

The overall model did not reach statistical significance in predicting attrition intentions, χ²(3, N = 104) = 5.93, p = .115, indicating that these subscale scores together did not significantly improve prediction over the null model.

Individually, none of the subscales were statistically significant predictors of attrition intentions: intrusion (OR = 1.10, 95% CI [0.91, 1.32], p = .322), avoidance (OR = 1.07, 95% CI [0.94, 1.23], p = .324), and arousal (OR = 0.93, 95% CI [0.75, 1.15], p = .504). This suggests that, when considered simultaneously, higher scores on these subscales were not associated with significantly greater or lower odds of intending to leave teaching.

Model 2 was not statistically significant, likely due to multicollinearity among the STSS subscales. As indicated by the exploratory analysis, the subscales were highly correlated. To further assess multicollinearity, the Variance Inflation Factor (VIF) was calculated for each predictor variable.

```{r, warning=FALSE, echo=TRUE}
#check variance inflation factor
vif(model2)
```


VIF values above 3 confirmed moderate to high multicollinearity, which may have masked individual predictor effects.

Since Model 2, which included all three subscale scores (Intrusion, Avoidance, and Arousal) as predictors, was not statistically significant, separate binary logistic regression analyses were conducted to examine whether each component of secondary traumatic stress individually predicted teachers’ intentions to leave the profession.

#### Model 3

Model 3 assessed the predictive value of the Intrusion subscale score on teachers’ intentions to leave the profession.

$$ 
\ln(\text{attrition}) = -2.1044 + 0.1091(\text{Intrusion Score}) 
$$
```{r, warning=FALSE, echo=TRUE}
# Model with intrusion only
model_intrusion <- glm(leave_teaching ~ intrusion_score, data = sts_data, family = binomial)
summary(model_intrusion)

```
Intrusion was a significant predictor of attrition intentions, χ²(1, N = 104) = 4.94, p = .031. For every one-point increase in intrusion scores, the odds of intending to leave teaching increased by approximately 11% (OR = 1.11, 95% CI [1.01, 1.23]).

#### Model 4

Model 4 used the Avoidance subscale score to predict teachers’ intentions to leave the profession.

$$ 
\ln(\text{attrition}) = -1.9626 + 0.0704(\text{Avoidance Score}) 
$$

```{r, warning=FALSE, echo=TRUE}

# Model with avoidance only
model_avoidance <- glm(leave_teaching ~ avoidance_score, data = sts_data, family = binomial)
summary(model_avoidance)


```
Avoidance also significantly predicted attrition intentions, χ²(1, N = 104) = 4.95, p = .030. For every one-point increase in avoidance scores, the odds of intending to leave increased by about 7% (OR = 1.07, 95% CI [1.01, 1.14]).

#### Model 5

Model 5 examined whether the Arousal subscale score predicted teachers’ intentions to leave the profession.

$$ 
\ln(\text{attrition}) = -1.8426 + 0.0820(\text{Arousal Score}) 
$$

```{r, warning=FALSE, echo=TRUE}
# Model with arousal only
model_arousal <- glm(leave_teaching ~ arousal_score, data = sts_data, family = binomial)
summary(model_arousal)

```

Arousal showed a trend towards significance, χ²(1, N = 104) = 3.27, p = .071. Higher arousal scores were associated with increased odds of intending to leave teaching, but this effect did not reach conventional levels of statistical significance (OR = 1.09, 95% CI [0.99, 1.18]).


#### Model Comparison and Diagnostics

Only the total score, intrusion, and avoidance models showed statistically significant results. The model with all three subscales combined did not reach significance, likely due to overlap between the subscales. Arousal, by itself, showed a possible trend but wasn’t strong enough to be considered significant.

```{r, warning=FALSE, echo=TRUE}


# Tidy each model and exponentiate to get odds ratios
tidy_model1 <- tidy(model1, conf.int = TRUE, exponentiate = TRUE) %>%
  mutate(Model = "Model 1", AIC = AIC(model1))

tidy_model3 <- tidy(model_intrusion, conf.int = TRUE, exponentiate = TRUE) %>%
  mutate(Model = "Model 3", AIC = AIC(model_intrusion))

tidy_model4 <- tidy(model_avoidance, conf.int = TRUE, exponentiate = TRUE) %>%
  mutate(Model = "Model 4", AIC = AIC(model_avoidance))

# Combine all models
combined_models <- bind_rows(tidy_model1, tidy_model3, tidy_model4)

# Filter out intercepts, rename, and capitalize predictor names
model_table <- combined_models %>%
  filter(term != "(Intercept)") %>%
  select(Model, term, estimate, std.error, conf.low, conf.high, p.value, AIC) %>%
  rename(
    Predictor = term,
    `Odds Ratio` = estimate,
    `Std. Error` = std.error,
    `CI Lower` = conf.low,
    `CI Upper` = conf.high,
    `p-value` = p.value
  ) %>%
  mutate(
    Predictor = case_when(
      Predictor == "stss_total_score" ~ "STSS Total Score",
      Predictor == "intrusion_score" ~ "Intrusion Score",
      Predictor == "avoidance_score" ~ "Avoidance Score",
      TRUE ~ Predictor
    )
  ) %>%
  arrange(Model)

# Display the table
kable(model_table, digits = 3, caption = "Comparison of Logistic Regression Models Predicting Teacher Attrition")

```

Both Model 1 (total secondary traumatic stress score) and Model 3 (intrusion subscale) fit the data equally well in predicting teacher attrition intentions, each yielding the lowest AIC values. Model 4 (avoidance subscale) also performed well and was statistically significant, indicating that avoidance symptoms are relevant to attrition decisions. However, its slightly higher AIC and the comparatively stronger association between intrusion scores and attrition suggest that Model 3 offers a more informative and efficient predictor. As such, the focus of further analysis and interpretation is placed on Models 1 and 3.

To ensure the validity of the logistic regression analyses, the linearity assumption between continuous predictors and the log odds of the outcome was assessed for both Model 1 (total secondary traumatic stress score) and Model 3 (intrusion subscale). Predicted probabilities from each model were transformed into log odds and plotted against their respective predictors. Visual inspection of these plots verified that the linearity assumption was adequately met for both models.

```{r}
# Set plotting area to 1 row, 2 columns (side by side)
par(mfrow = c(1, 2))

# Model 1: STSS Total Score
sts_data$pred_prob_model1 <- predict(model1, type = "response")
sts_data$log_odds_model1 <- log(sts_data$pred_prob_model1 / (1 - sts_data$pred_prob_model1))

plot(sts_data$stss_total_score, sts_data$log_odds_model1,
     xlab = "STSS Total Score",
     ylab = "Log Odds of Leaving Teaching",
     main = "Linearity Check for Model 1")

# Model 3: Intrusion Score
sts_data$pred_prob_model3 <- predict(model_intrusion, type = "response")
sts_data$log_odds_model3 <- log(sts_data$pred_prob_model3 / (1 - sts_data$pred_prob_model3))

plot(sts_data$intrusion_score, sts_data$log_odds_model3,
     xlab = "Intrusion Score",
     ylab = "Log Odds of Leaving Teaching",
     main = "Linearity Check for Model 3")

# Reset plotting area back to default (optional)
par(mfrow = c(1, 1))

```

Since Model 1 and Model 3 had the lowest and identical AIC values, diagnostic tests were conducted on these models. These included the Hosmer-Lemeshow goodness-of-fit test, likelihood ratio test, assessment of the significance of individual predictors, and evaluation of predictive performance using classification metrics such as accuracy, sensitivity, and specificity.


```{r, warning=FALSE, echo=TRUE}
library(ResourceSelection)
library(caret)

models <- list(
  Model1 = model1,
  Model3 = model_intrusion
)

results <- lapply(models, function(mod) {
  # Hosmer-Lemeshow Test
  hl <- hoslem.test(mod$y, fitted(mod))
  
  # Null model for LRT
  null_mod <- glm(leave_teaching ~ 1, family = binomial, data = sts_data)
  lrt <- anova(null_mod, mod, test = "Chisq")
  
  # Predictions and confusion matrix
  pred_probs <- predict(mod, type = "response")
  pred_class <- ifelse(pred_probs > 0.5, 1, 0)
  cm <- confusionMatrix(factor(pred_class), factor(sts_data$leave_teaching))
  
  list(
    HosmerLemeshow_p = hl$p.value,
    LRT_p = lrt$`Pr(>Chi)`[2],
    Accuracy = cm$overall["Accuracy"],
    Sensitivity = cm$byClass["Sensitivity"],
    Specificity = cm$byClass["Specificity"]
  )
})

# Convert results to data.frame
diagnostic_summary <- do.call(rbind, lapply(results, as.data.frame))
rownames(diagnostic_summary) <- names(models)
diagnostic_summary

```

$$
\text{Hosmer-Lemeshow (HL) Test}
$$

$$
H_0:
\text{The logistic regression model fits the data well.}
$$

$$
H_1:
\text{The model does not fit the data well.}
$$

Both Model 1 (total STSS score) and Model 3 (intrusion score) demonstrated good overall fit based on the Hosmer-Lemeshow test (Model 1: p = .605; Model 3: p = .336), indicating no significant lack of fit.

$$
\text{Likelihood Ratio Test}
$$
$$
H_0:
\text{The simpler model (with no predictors) fits the data as well as the more complex model.}
$$
$$
H_1:
\text{The more complex model (with predictors) fits the data significantly better than the simpler model.}
$$

Likelihood ratio tests showed that both models significantly improved prediction over a null model with no predictors (Model 1: p = .026; Model 3: p = .026).

$$
\text{Accuracy, Sensitivity and Specificity}
$$

In terms of classification accuracy, Model 3 slightly outperformed Model 1 (68.3% vs. 67.3%), primarily due to a marginally higher sensitivity (ability to correctly identify teachers intending to leave). Both models showed low specificity (~11.8%), indicating limited ability to correctly identify those intending to stay.


### Conclusion

-   Summarize your key findings.

-   Discuss the implications of your results.

The main goal of this analysis was to identify a model that accurately predicts teacher attrition. Both Model 1 and Model 3 achieved similar overall accuracy, correctly classifying nearly 70% of cases. However, while these models demonstrated high sensitivity—effectively identifying teachers who intend to leave—they showed low specificity, correctly identifying only about 12% of teachers who intend to stay. This indicates that although the models are strong at predicting attrition, they are limited in accurately recognizing those who will remain in teaching. Future analyses could focus on improving model specificity, potentially by adjusting classification thresholds or incorporating additional predictors, to better balance the identification of both teachers who leave and those who stay.



## References
